# 字符串和格式化输入、输出

## 字符串的终止靠的是 0 或者 `'\0'`

```c
int main(void) {
  char ch[10] = {'a', 'b', 'c', 'd'};

  printf("%s", ch);

  return 0;
}
```

在上述代码中，定义了一个以十个字符为单位的数组，而又仅定义了数组内的 4 个元素，所以其他六个元素自动的被填充为 `'\0'`（字符 `'\0'` 的 ASCII 码值即为 0，但字符 `'0'` 的 ASCII 码值为 48），因此打印出来的就是 `abcd`。

```c
int main(void) {
  char ch[4] = {'a', 'b', 'c', 'd'};

  printf("%s\n", ch);

  return 0;
}
```

在上述代码中，定义了一个以四个字符为单位的数组，而组内 4 个元素均被定义，因此没有 `'\0'`，程序会在内存中寻找 `'\0'` 来终止字符，因此会乱码，打印出来 `abcd 烫烫烫烫烫烫烫烫烫烫烫烫烫烫烫烫烫?H?`。

## 转义字符

| 转义字符 |                        释义                        |
| :------: | :------------------------------------------------: |
|   `\?`   | 在书写连续多个问号时使用，防止他们被解析成三字母词 |
|   `\'`   |                  用于表示字符常量                  |
|   `\\`   |  用于表示一个反斜杠，防止它被解释为一个转义序列符  |
|   `\a`   |                   警号字符，蜂鸣                   |
|   `\b`   |                       退格符                       |
|   `\f`   |                       换页符                       |
|   `\n`   |                        换行                        |
|   `\r`   |                        回车                        |
|   `\v`   |                     垂直制表符                     |
|  `\ddd`  |     ddd 表示 1~3 个八进制的数字，如：`\130` X      |
|  `\xdd`  |       dd 表示 2 个十六进制数字，如：`\x30` 0       |

### 水平制表符 `\t` 的举例使用

```c
#include <stdio.h>

int main(void) {
  printf("Name	Age	Gender\n");
  printf("Jacy\t18\tMan\n");

  return 0;
}
```

便会输出：

```
Name	Age	Gender
Jacy	18	Man
```

### 八进制和十六进制的转义字符注意事项

八进制的数用 0～7 来表示（注意，不能超过这些数字的范围）；而十六进制的数用 0~f 来表示的（从十开始就是用 a 之类的字母来表示，同样不能超出范围）；举例：

`\628` 中 `\62` 组成了一个八进制转义字符，它可以表示对应的数字 49。

---

```c
#include <stdio.h>

int main(int argc, char** argv) {
  float salary;
  printf("\aEnter your desired monthly salary:");
  printf("$_______\b\b\b\b\b\b\b");
  scanf("%f", &salary);
  printf("\n\t$%.2f a month is $%.2f a year.", salary, salary * 12.0);
  printf("\rGee!\n");
  return 0;
}

```

<img src="../images/image-202508250352.webp" style="zoom:80%;" />

退格符 `\b` 移动光标，但不会清除之前的内容。而回车符 `\r` 会将光标移动到字符串起始位置，而不是下一行。

## ASCII 码

<img src="../images/image-202508250356.webp"  />

```c
int main(void) {
  char arr[] = {65, 66, 67, 68, 69, 70, 71, 72, 73};
  int sz = sizeof(arr) / sizeof(arr[0]), i = 0;

  while (i < sz) {
    printf("%c", arr[i]);
    i++;
  }

  return 0;
}
```

上述代码最终会输出 `ABCDEFGHI` 这个字符，说明字符的真实面目其实是一串串数字。当转换说明为 `%d` 时，便会输出数字；为 `%s`（`%c`）时，便会输出字符。

## 计算字符串大小的函数 `strlen`

```c
int main()
{
    printf("%d\n", strlen("abcdef"));
    // \62被解析成一个转义字符
    printf("%d\n", strlen("c:\test\628\test.c"));
    return 0;
}
```

可以输出 `6` 和 `14`。

## 转换说明

<img src="../images/image-202508250358.png" style="zoom: 67%;" />

`%Lf` 或者 `%Le` 代表 `long double` 类型的值。

打印十六进制和八进制数时，可以使用 `%o` 打印八进制数，`%x` 打印十六进制数，而 `%#o` 和 `%#x` 可以保留前缀。

`%e` 可以打印指数类型的浮点数，而 `a` 是十六进制下的浮点数表示，并自动添加前缀。

在 C 语言中，精度和宽度分别用于不同的格式化符号中。

- **精度（precision）**：通常用于浮点数或字符串的格式化中，用来指定输出的小数位数或者字符串的最大长度
- **宽度（width）**：通常用于整数或字符串的格式化中，用来指定输出的最小字符数

在这两种情况下，精度和宽度都可以通过 `*` 动态指定。

`%.*s`：C 语言中的格式化输出符号，用于按指定长度输出字符串。

具体来说，`%.*s` 中的 `.*` 是一个整数格式修饰符，它告诉 `printf` 函数后面的参数是一个整数，用来控制输出字符的最大数量。而 `s` 表示后面的参数是字符串类型。

举个例子，如果我们有一个字符串 `str`，要输出其中的前 5 个字符，可以使用 `printf` 语句：

```c
printf("%.*s", 5, str);
```

这将会输出字符串 `str` 的前 5 个字符。这种格式化方式可以非常灵活地控制字符串的输出长度，适用于各种需要限制字符串输出长度的场景。

- `%.*d`：表示输出一个带有指定精度的整数
- `%*d`：表示输出一个带有指定宽度的整数
- `%.*s`：表示输出一个带有指定精度的字符串
- `%*s`：表示输出一个带有指定宽度的字符串

举例：

```c
int precision = 4;
int width = 6;
char *str = "example";

printf("%.*d\n", precision, 12345);  // 输出：1234
printf("%*d\n", width, 123);         // 输出：   123
printf("%.*s\n", precision, str);    // 输出：exam
printf("%*s\n", width, str);         // 输出：example
```

当超过指定宽度时，原样输出是因为超过宽度的部分会被完整地输出而不会被截断。这是因为在 C 语言中，格式化输出中指定的宽度是最小宽度，如果实际内容长度超过了指定宽度，那么内容会被完整输出，不会被截断。

也有这种说法 `%*.*d`。

- **宽度参数**：宽度参数用于指定字符串的**最小宽度**；当输出的字符串长度小于宽度参数时，在输出时会在左侧补充空格字符以达到指定的宽度；如果字符串的长度超过了宽度参数，那么输出不会被截断或缩短
- **精度参数**：精度参数用于指定字符串的**最大长度**；当输出的字符串长度超过了精度参数时，会将字符串截断为指定长度；截断后的字符串末尾会添加省略号 `...` 来表示字符串被截断了

---

**总结**：

- **精度**：当为字符串时，`%.2s` 表示最多输出字符串的两个字符，若字符串长度小于 2，则由实际字符串输出；当为浮点数时，`%.2f`表示小数点后面精度最多两位，`%.2d` 则代表输出的整数的最小宽度，不够的补上前导 0

- **宽度**：如 `%2d`，则输出的整数要有 2 个位宽，没有的补齐，`%-2d` 代表左对齐，`%02d` 代表用 0 来补齐

